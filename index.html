<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Golf Game</title>
    <script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>
  </head>
  <body>
    <a-scene physics="gravity: -9.8">
      <!-- Lighting -->
      <a-entity light="type: ambient; intensity: 0.6"></a-entity>
      <a-entity light="type: directional; intensity: 0.6" position="0 10 5"></a-entity>

      <!-- Camera -->
      <a-entity
        id="cameraRig"
        position="0 2 5"
        movement-controls="fly: false"
      >
        <a-entity
          camera
          look-controls="pointerLockEnabled: true; touchEnabled: true"
          position="0 1.6 0"
        ></a-entity>
      </a-entity>

      <!-- Ground -->
      <a-box
        id="ground"
        position="0 0 0"
        rotation="0 0 0"
        width="100"
        height="0.1"
        depth="200"
        color="green"
        static-body
      ></a-box>

      <!-- Ball -->
      <a-sphere
        id="ball"
        position="0 1 0"
        radius="0.3"
        color="white"
        dynamic-body="mass: 1"
      ></a-sphere>

      <!-- Ramp -->
      <a-box
        position="0 0.5 -50"
        rotation="-20 0 0"
        width="10"
        height="0.2"
        depth="10"
        color="brown"
        static-body
      ></a-box>

      <!-- Walls -->
      <a-box position="0 2 -100" width="100" height="4" depth="1" color="gray" static-body></a-box>
      <a-box position="0 2 100" width="100" height="4" depth="1" color="gray" static-body></a-box>
      <a-box position="50 2 0" width="1" height="4" depth="200" color="gray" static-body></a-box>
      <a-box position="-50 2 0" width="1" height="4" depth="200" color="gray" static-body></a-box>

      <!-- Hole -->
      <a-cylinder
        id="hole"
        position="0 0.05 -180"
        radius="0.4"
        height="0.05"
        color="black"
      ></a-cylinder>
    </a-scene>

    <script>
      const ball = document.getElementById("ball");
      const cameraRig = document.getElementById("cameraRig");
      let angle = 0;

      document.addEventListener("keydown", (e) => {
        const force = 10;
        const rotSpeed = 2;
        const ballBody = ball.body;

        switch (e.key.toLowerCase()) {
          case "q":
            angle += rotSpeed;
            break;
          case "e":
            angle -= rotSpeed;
            break;
          case " ":
            if (ballBody) {
              const dir = new CANNON.Vec3(
                -Math.sin(THREE.MathUtils.degToRad(angle)),
                0.3,
                -Math.cos(THREE.MathUtils.degToRad(angle))
              );
              dir.scale(force, dir);
              ballBody.velocity.set(dir.x, dir.y, dir.z);
            }
            break;
        }
      });

      // Keep camera behind ball
      function updateCamera() {
        const pos = ball.object3D.position;
        const distance = 5;
        const height = 2;
        const rad = THREE.MathUtils.degToRad(angle);
        const camX = pos.x + Math.sin(rad) * distance;
        const camZ = pos.z + Math.cos(rad) * distance;

        cameraRig.object3D.position.set(camX, height, camZ);
        cameraRig.object3D.lookAt(pos);
        requestAnimationFrame(updateCamera);
      }
      updateCamera();
    </script>
  </body>
</html>
