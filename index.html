<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Mini Golf Maze Course</title>
<script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>
</head>
<body>
<a-scene>

  <!-- Sky and ground -->
  <a-sky color="#87CEEB"></a-sky>
  <a-plane color="#2d5016" rotation="-90 0 0" width="500" height="500"></a-plane>
  
  <!-- Path/fairway sections -->
  <a-box position="0 0.01 -20" width="4" height="0.02" depth="40" color="#3a7d44"></a-box>
  <a-box position="5 0.01 -60" width="4" height="0.02" depth="40" rotation="0 15 0" color="#3a7d44"></a-box>
  <a-box position="-3 0.01 -100" width="4" height="0.02" depth="50" rotation="0 -20 0" color="#3a7d44"></a-box>
  <a-box position="2 0.01 -150" width="4" height="0.02" depth="40" rotation="0 10 0" color="#3a7d44"></a-box>
  <a-cylinder position="0 0.02 -190" radius="3" height="0.03" color="#4a9d5a"></a-cylinder>

  <!-- Walls along fairway -->
  <a-box position="-2 0.5 -20" width="0.2" height="1" depth="40" color="#5c4033"></a-box>
  <a-box position="2 0.5 -20" width="0.2" height="1" depth="40" color="#5c4033"></a-box>

  <a-box position="3 0.5 -60" width="0.2" height="1" depth="40" rotation="0 15 0" color="#5c4033"></a-box>
  <a-box position="7 0.5 -60" width="0.2" height="1" depth="40" rotation="0 15 0" color="#5c4033"></a-box>

  <a-box position="-4 0.5 -100" width="0.2" height="1" depth="50" rotation="0 -20 0" color="#5c4033"></a-box>
  <a-box position="-0.5 0.5 -100" width="0.2" height="1" depth="50" rotation="0 -20 0" color="#5c4033"></a-box>

  <a-box position="1 0.5 -150" width="0.2" height="1" depth="40" rotation="0 10 0" color="#5c4033"></a-box>
  <a-box position="5 0.5 -150" width="0.2" height="1" depth="40" rotation="0 10 0" color="#5c4033"></a-box>

  <!-- Obstacles (bounce like walls) -->
  <a-box position="0 0.2 -40" width="1" height="0.5" depth="2" color="#d62828"></a-box>
  <a-box position="5 0.2 -75" width="1" height="0.5" depth="2" color="#d62828"></a-box>
  <a-box position="-2 0.2 -120" width="1" height="0.5" depth="2" color="#d62828"></a-box>
  <a-box position="3 0.2 -160" width="1" height="0.5" depth="2" color="#d62828"></a-box>

  <!-- Hole -->
  <a-cylinder id="hole" position="0 0 -190" radius="0.3" height="0.1" color="#000000"></a-cylinder>
  <a-cylinder position="0 0.8 -190" radius="0.03" height="1.6" color="#ffffff"></a-cylinder>
  <a-box position="0 1.5 -190" width="0.5" height="0.3" depth="0.02" color="#ff0000"></a-box>

  <!-- Ball -->
  <a-sphere id="ball" position="0 0.5 -5" radius="0.2" color="#ffffff"></a-sphere>

  <!-- Camera -->
  <a-entity id="cameraRig" position="0 3 6">
    <a-camera id="camera"></a-camera>
  </a-entity>

  <!-- Aim arrow -->
  <a-entity id="aimArrow" line="start: 0 0.5 0; end: 0 0.5 -2; color: red"></a-entity>

</a-scene>

<script>
const ball = document.querySelector("#ball");
const cameraRig = document.querySelector("#cameraRig");
const camera = document.querySelector("#camera");
const aimArrow = document.querySelector("#aimArrow");

let ballVel = {x:0, z:0};
let aimAngle = 0;
const orbitHeight = 3;
let orbitX = 0;
let orbitZ = 6;

// WASD camera controls
const camSpeed = 0.5;
const keys = {};
window.addEventListener("keydown", e => keys[e.code] = true);
window.addEventListener("keyup", e => keys[e.code] = false);

// Q/E aim and Space putt
window.addEventListener("keydown", e => {
  if (e.code === "KeyQ") aimAngle -= 0.05;
  if (e.code === "KeyE") aimAngle += 0.05;
  if (e.code === "Space") {
    const power = 0.5;
    ballVel.x = Math.sin(aimAngle) * power;
    ballVel.z = -Math.cos(aimAngle) * power;
  }
});

// Camera update
function updateCamera() {
  const pos = ball.getAttribute("position");
  if (keys['KeyW']) orbitZ -= camSpeed;
  if (keys['KeyS']) orbitZ += camSpeed;
  if (keys['KeyA']) orbitX -= camSpeed;
  if (keys['KeyD']) orbitX += camSpeed;

  cameraRig.setAttribute("position", {
    x: pos.x + orbitX,
    y: pos.y + orbitHeight,
    z: pos.z + orbitZ
  });
  camera.object3D.lookAt(new THREE.Vector3(pos.x, pos.y + 0.5, pos.z));
  requestAnimationFrame(updateCamera);
}
updateCamera();

// Ball update with collisions
function updateBall() {
  const pos = ball.getAttribute("position");
  pos.x += ballVel.x;
  pos.z += ballVel.z;
  pos.y = 0.5;

  // Wall collision boxes
  const wallBoxes = [
    {x:-2, z:-20, w:0.2, d:40},{x:2, z:-20, w:0.2, d:40},
    {x:3, z:-60, w:0.2, d:40},{x:7, z:-60, w:0.2, d:40},
    {x:-4, z:-100, w:0.2, d:50},{x:-0.5, z:-100, w:0.2, d:50},
    {x:1, z:-150, w:0.2, d:40},{x:5, z:-150, w:0.2, d:40}
  ];

  // Obstacles (bounce like walls)
  const obstacles = [
    {x:0, z:-40, w:1, d:2},{x:5, z:-75, w:1, d:2},
    {x:-2, z:-120, w:1, d:2},{x:3, z:-160, w:1, d:2}
  ];

  const allColliders = wallBoxes.concat(obstacles);
  for (let c of allColliders) {
    if (Math.abs(pos.x - c.x) < c.w/2 + 0.2 && Math.abs(pos.z - c.z) < c.d/2 + 0.2) {
      ballVel.x *= -0.8;
      ballVel.z *= -0.8;
    }
  }

  // Friction
  ballVel.x *= 0.95;
  ballVel.z *= 0.95;
  if (Math.abs(ballVel.x) < 0.001) ballVel.x = 0;
  if (Math.abs(ballVel.z) < 0.001) ballVel.z = 0;

  ball.setAttribute("position", pos);
  requestAnimationFrame(updateBall);
}
updateBall();

// Aim arrow
function updateAimArrow() {
  const pos = ball.getAttribute("position");
  const endX = pos.x + Math.sin(aimAngle) * 2;
  const endZ = pos.z - Math.cos(aimAngle) * 2;
  aimArrow.setAttribute("line", `start: ${pos.x} 0.5 ${pos.z}; end: ${endX} 0.5 ${endZ}; color: red`);
  requestAnimationFrame(updateAimArrow);
}
updateAimArrow();
</script>
</body>
</html>
